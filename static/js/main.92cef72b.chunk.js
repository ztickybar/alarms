(this["webpackJsonpztickybar-notifier"]=this["webpackJsonpztickybar-notifier"]||[]).push([[0],{205:function(e,t){e.exports="data:image/png;base64,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"},206:function(e){e.exports=JSON.parse('{"name":"ztickybar-notifier","version":"0.1.5","private":true,"dependencies":{"@microsoft/microsoft-graph-client":"^2.0.0","@uifabric/fluent-theme":"^7.1.4","animejs":"^3.1.0","axios":"^0.19.0","dexie":"^2.0.4","dexie-observable":"^1.0.0-beta.5","dexie-syncable":"^1.0.0-beta.4","exceljs":"^3.5.0","https":"^1.0.0","into-stream":"5.1.1","lodash":"^4.17.15","mammoth":"^1.4.9","moment":"^2.24.0","msal":"^1.2.1","office-ui-fabric-core":"^11.0.0","office-ui-fabric-react":"^7.61.1","quill-delta-to-html":"^0.11.0","react":"^16.12.0","react-dom":"^16.12.0","react-dropzone":"^10.2.1","react-grid-layout":"^0.17.1","react-resizable":"^1.10.1","react-scripts":"3.2.0","string-to-stream":"^3.0.1","xlsx":"^0.15.4","format-json":"^1.0.3"},"devDependencies":{"gh-pages":"^2.1.1"},"scripts":{"start":"PORT=3002 react-scripts start","build":"react-scripts build","test":"react-scripts test","eject":"react-scripts eject","config-default":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js","config-nets":"cp src/config/nets/index.html public/index.html && cp src/config/nets.js src/config/index.js","deploy":"cp src/config/default/index.html public/index.html && cp src/config/default.js src/config/index.js && react-scripts build && gh-pages -b master -d build -r https://github.com/ztickybar/alarms","deploy-nets":"cp src/config/nets/index.html public/index.html && cp src/config/nets.js src/config/index.js && react-scripts build && echo alerts.nets-intranets.com > build/CNAME && cp build/index.html build/404.html && gh-pages -b master -d build -r https://github.com/nets-intranets/notify"},"eslintConfig":{"extends":"react-app"},"browserslist":{"production":[">0.2%","not dead","not op_mini all"],"development":["last 1 chrome version","last 1 firefox version","last 1 safari version"]}}')},222:function(e,t,n){e.exports=n(456)},227:function(e,t,n){},245:function(e,t){},247:function(e,t){},279:function(e,t){},280:function(e,t){},345:function(e,t){},438:function(e,t,n){},455:function(e,t){},456:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n.n(r),a=n(56),o=n.n(a),c=(n(227),n(34)),s=n.n(c),l=n(58),u=n(35),p=n(203),f=n(204),d=(n(229),n(205)),m=n.n(d),g={clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",scopes:["user.readwrite","Sites.Read.All"],title:"ZTICKYBAR Notifier",isAnomyous:!0,rss:"https://jumpto36500001.blob.core.windows.net/config/sharepoint.com/j/u/m/jumpto365homepage/rss.json",currentAlerts:"https://graph.microsoft.com/v1.0/sites/christianiabpos.sharepoint.com:/sites/intranets-corp:/lists/currentAlerts/items?expand=fields",components:{header:i.a.createElement("div",{style:{borderBottom:"1px solid #cccccc"}},i.a.createElement("div",{style:{display:"flex",margin:"20px"}},i.a.createElement("div",null,i.a.createElement("img",{style:{height:"20px",padding:"4px"},src:m.a})),i.a.createElement("div",{style:{marginLeft:"16px",fontSize:"20px",lineHeight:"20px",padding:"4px"}},"Alerts")))}},h=n(217),v=n(216);var b={getAccessToken:function(e){var t=window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname;console.log("login replyUrl",t);var n={auth:{clientId:g.clientId,redirectUri:t,storeAuthStateInCookie:!0,authority:"https://login.microsoftonline.com/common"}},r=new v.a(n);return new Promise(function(){var t=Object(l.a)(s.a.mark((function t(n,i){var a,o,c;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a={scopes:e},r.handleRedirectCallback((function(e,t){})),t.prev=2,t.next=5,r.acquireTokenSilent(a);case 5:o=t.sent,n(o.accessToken),t.next=18;break;case 9:t.prev=9,t.t0=t.catch(2),t.t1=t.t0.errorCode,t.next="user_login_error"===t.t1?14:16;break;case 14:return r.getAccount()||r.getLoginInProgress()||((c=sessionStorage.getItem("loops")?parseInt(sessionStorage.getItem("loops")):0)>3&&(sessionStorage.setItem("loops",0),sessionStorage.clear(),window.location.reload()),sessionStorage.setItem("loops",c+1),r.loginRedirect(a)),t.abrupt("break",17);case 16:return t.abrupt("break",17);case 17:i(t.t0);case 18:case"end":return t.stop()}}),t,null,[[2,9]])})));return function(e,n){return t.apply(this,arguments)}}())}},k=n(49),A=n.n(k),x=n(128),y=n.n(x),w=n(476),S=n(8),E=n(215),J=n(475),O=(n(438),n(206)),I=n(207),j=n.n(I);Object(h.a)();var N=function(){function e(){var t=this;Object(p.a)(this,e),this.tools=function(){return new Promise((function(e,t){e([])}))},this.setNotificationCount=function(e,n){var r=window.self!==window.top?window.top:window.self;r&&r.postMessage({action:"setNotificationCount",count:n,tileId:e,key:t._key},t._targetOrigin)},this._key="123",this._targetOrigin="*"}return Object(f.a)(e,[{key:"openerHref",get:function(){return this._openerHref}},{key:"tileId",get:function(){return this._tileId}}]),e}();N.init=function(){return new N};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(455);o.a.render(i.a.createElement((function(){var e=["User.ReadWrite","Sites.Read.All"],t="seenalerts",n=Object(r.useState)(!0),a=Object(u.a)(n,2),o=a[0],c=(a[1],Object(r.useState)([])),p=Object(u.a)(c,2),f=p[0],d=p[1],m=Object(r.useState)({}),h=Object(u.a)(m,2),v=h[0],k=h[1],x=Object(r.useState)([]),I=Object(u.a)(x,2),C=I[0],R=I[1],z=Object(r.useState)([]),U=Object(u.a)(z,2),P=U[0],Z=U[1],Q=function(){try{return window.self!==window.top}catch(e){return!0}}(),V=Object(r.useState)(""),B=Object(u.a)(V,2),K=B[0],q=B[1],L=Object(r.useState)(0),T=Object(u.a)(L,2),D=T[0],F=T[1],X=Object(r.useState)(!1),W=Object(u.a)(X,2),Y=W[0],H=W[1],M=Object(r.useState)(0),G=Object(u.a)(M,2),_=G[0],$=G[1];function ee(){return(ee=Object(l.a)(s.a.mark((function t(){var n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!g.isAnomyous){t.next=4;break}return ne([]),t.abrupt("return");case 4:return t.next=6,b.getAccessToken(e);case 6:return n=t.sent,q(n),t.next=10,A.a.get(n,"https://graph.microsoft.com/v1.0/me");case 10:r=t.sent,k(r),t.next=23;break;case 14:t.prev=14,t.t0=t.catch(0),t.t1=t.t0.errorCode,t.next="user_login_error"===t.t1?19:20;break;case 19:case 20:return t.abrupt("break",21);case 21:f.push({context:" OfficeGraph.auth.getAccessToken()",error:t.t0}),d(f);case 23:case"end":return t.stop()}}),t,null,[[0,14]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){N.init();var e=localStorage.getItem("ztickyBarNotificationCount");e&&parseInt(e);!function(){ee.apply(this,arguments)}(),K&&A.a.get(K,"https://graph.microsoft.com/v1.0/me/extensions/".concat(g.extensionName)).then((function(e){try{te(e.seenAlerts)}catch(t){f.push({context:"Post init",error:t}),d(f),te(null)}})).catch((function(e){f.push({context:"OfficeGraph.myExtentions() ",error:e}),d(f)}))}),[K,D]),i.a.createElement("div",{style:{position:"relative",height:"95vh"}},!Q&&g.components&&g.components.header&&g.components.header,f.length>0&&i.a.createElement(w.a,{messageBarType:S.a.error,isMultiline:!1,onDismiss:function(){d(f.slice(1))},dismissButtonAriaLabel:"Close"},"Error: ",JSON.stringify(f[0])),i.a.createElement("div",{style:{backgroundColor:"#eeeeee"}},i.a.createElement("div",{style:{padding:"20px",marginLeft:"auto",marginRight:"auto",maxWidth:"1280px",backgroundColor:"#ffffff",height:"80vh"}},!o&&i.a.createElement("div",{style:{textAlign:"center",marginTop:"30vh"}},i.a.createElement(E.a,{text:"Sign in",onClick:function(){alert("Not implemented")}})),C.map((function(e,t){return i.a.createElement("div",{className:"alert"},i.a.createElement("div",{style:{fontWeight:e.read?300:600,display:"flex",cursor:Y?"wait":"pointer"},onClick:function(){Y||e.read||(H(!0),P.push({id:e.id,url:e.url,date:y.a.utc()}),ie(P).then((function(){H(!1)})).catch((function(){H(!1)})))}},i.a.createElement("div",{style:{position:"relative",flexGrow:1}},i.a.createElement("div",{style:{fontSize:"24px",padding:"10px"}},e.title),i.a.createElement("div",{style:{fontSize:"12px",padding:"10px"}},e.message),i.a.createElement("div",{style:{fontSize:"12px",padding:"10px"}},"Last updated: ",y()(e.date).format("LLLL")))))})))),!Q&&i.a.createElement("div",{style:{position:"absolute",bottom:0}},i.a.createElement("div",{style:{display:"flex",width:"100vw"}},i.a.createElement("div",{style:{flexGrow:1,padding:8}},v&&i.a.createElement("div",null,v.displayName," (",v.userPrincipalName,")"),g.alertsUrl&&i.a.createElement("a",{href:g.alertsUrl,target:"_blank"},g.alertsUrl),i.a.createElement("div",null,i.a.createElement("button",{onClick:function(){var e=localStorage.getItem("ztickyBarNotificationCount"),t=e?parseInt(e)>0?parseInt(e)+1:1:0;localStorage.setItem("ztickyBarNotificationCount",t),N.init().setNotificationCount(3,t)}},"+"),i.a.createElement("button",{onClick:function(){var e=localStorage.getItem("ztickyBarNotificationCount"),t=e?parseInt(e)>0?parseInt(e)-1:1:0;localStorage.setItem("ztickyBarNotificationCount",t),N.init().setNotificationCount(3,t)}},"-"))),i.a.createElement("div",{style:{flexGrow:1}},i.a.createElement("div",null,"Unread: ",_),i.a.createElement("div",null,i.a.createElement(J.a,{text:"clear",onClick:function(){ie([])}})," ",i.a.createElement(J.a,{text:"clear session",onClick:function(){sessionStorage.clear(),window.location.reload()}})),JSON.stringify(P)),i.a.createElement("div",{style:{padding:8,textAlign:"right"}},i.a.createElement("div",null,i.a.createElement("a",{href:"https://www.jumpto365.com",target:"_blank"},"ZTICKYBAR Notifier")),i.a.createElement("div",null,"Version ",O.version)))));function te(e){A.a.get(K,g.currentAlerts).then((function(t){var n={};if(t){var r=t.map((function(e){try{var t={id:e.fields.id,title:e.fields.Title,active:e.fields.Active,date:e.fields.Date,message:e.fields.Message,image:e.fields.RollupImage?e.fields.RollupImage.Url:null,url:e.fields.Url?e.fields.Url.Url:null};return n[e.fields.id]=t,t}catch(r){f.push({context:"OfficeGraph.getAlerts() map ",error:r}),d(f)}})),i=[];e&&e.forEach((function(e){n[e.id]&&(n[e.id].read=!0,i.push({id:e.id,url:n[e.id].url}))}));var a=r.length-e.length,o=N.init();$(a),window.document.title=a>0?g.title+" ("+a+" unread)":g.title,o.setNotificationCount(3,a),R(r),Z(e)}})).catch((function(e){f.push({context:"OfficeGraph.getAlerts() ",error:e}),d(f)}))}function ne(){return re.apply(this,arguments)}function re(){return(re=Object(l.a)(s.a.mark((function e(){var n,r,i,a,o,c,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem(t),r=n?JSON.parse(n):[],i={},e.prev=3,e.next=6,j.a.get(g.rss);case 6:a=e.sent,e.next=13;break;case 9:e.prev=9,e.t0=e.catch(3),f.push({context:" OfficeGraph.auth.getAccessToken()",error:e.t0}),d(f);case 13:o=a.data.rss.channel.item.map((function(e){try{var t=e["media:content"],n=t||null,r=n?n["-url"]:null,a={id:e.guid,read:!1,title:e.title,active:!0,date:e.pubDate,message:e.description,image:r,url:e.link};return i[e.guid]=a,a}catch(o){f.push({context:"OfficeGraph.getAlerts() map ",error:o}),d(f)}})),c=[],r&&r.forEach((function(e){i[e.id]&&(i[e.id].read=!0,c.push({id:e.id,url:i[e.id].url}))})),l=o.length-r.length,u=N.init(),$(l),window.document.title=l>0?g.title+" ("+l+" unread)":g.title,u.setNotificationCount(3,l),R(o),Z(r);case 23:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function ie(e){if(g.isAnomyous){var n=JSON.stringify(e);return localStorage.setItem(t,n),new Promise((function(e,t){e()}))}return new Promise(function(){var t=Object(l.a)(s.a.mark((function t(n,r){var i;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,A.a.get(K,"https://graph.microsoft.com/v1.0/me/extensions/".concat(g.extensionName));case 2:i=t.sent,(i?A.a.patch(K,"https://graph.microsoft.com/v1.0/me/extensions/".concat(g.extensionName),{"@odata.type":"#microsoft.graph.openTypeExtension",extensionName:g.extensionName,seenAlerts:e,etag:i.etag+1,id:g.extensionName}):A.a.post(K,"https://graph.microsoft.com/v1.0/me/extensions",{"@odata.type":"#microsoft.graph.openTypeExtension",extensionName:g.extensionName,seenAlerts:e,etag:1,id:g.extensionName})).then((function(e){try{F(D+1),n()}catch(t){f.push({context:"Post init",error:t}),d(f),te(null),n()}})).catch((function(e){f.push({context:"setSeenAlerts ",error:e}),d(f),n()}));case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},49:function(e,t,n){var r=n(230),i={},a={tokenEndpoint:"https://login.microsoftonline.com/common/oauth2/token"};i.getAccessToken=function(){if(window)throw"Not valid client side";return new Promise((function(e,t){var n={grant_type:"client_credentials",client_id:a.clientId,client_secret:a.clientSecret,resource:"https://graph.microsoft.com"};r.post({url:a.tokenEndpoint,form:n},(function(n,r,i){var a=JSON.parse(i);n?t(n):a.error?t(a.error_description):e(a.access_token)}))}))},e.exports.getRaw=function(e,t){return console.log("getting",t),new Promise((function(n,i){r.get({url:t,headers:{authorization:"Bearer "+e}},(function(e,t,r){if(e)return n({hasError:!0,error:e});n({hasError:!1,result:r})}))}))},e.exports.get=function(e,t){return new Promise((function(n,i){!function e(t,n,i,a,o,c){console.log("getting",n,!0===a),r.get({url:n,headers:{"content-type":"application/json",authorization:"Bearer "+t}},(function(r,s,l){var u,p;if(r){var f=c?c+1:1;return f>3?i(r,null,o):(console.log("retry #",f),e(t,n,i,a,o,f))}return(u=JSON.parse(l)).error?i(u.error,null,o):u["@odata.nextLink"]?(p=a?a.concat(u.value):u.value,e(t,u["@odata.nextLink"],i,p,o)):void(a?i(null,a.concat(u.value),o):u.value?i(null,u.value,o):i(null,u,o))}))}(e,t,(function(e,t){if(e)return i(e);n(t)}))}))},e.exports.post=function(e,t,n){return new Promise((function(i,a){!function(e,t,n,i){r.post({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var r;return e?i(e):(r=""===n?{}:JSON.parse(n)).error?i(r.error):void i(null,r)}))}(e,t,n,(function(e,t){if(e)return a(e);i(t)}))}))},e.exports.patch=function(e,t,n){return new Promise((function(i,a){!function(e,t,n,i){r.patch({url:t,headers:{"content-type":"application/json",authorization:"Bearer "+e},body:JSON.stringify(n)},(function(e,t,n){var r;return e?i(e):(r=""===n?{}:JSON.parse(n)).error?i(r.error):void i(null,r)}))}(e,t,n,(function(e,t){if(e)return a(e);i(t)}))}))},e.exports.auth=i}},[[222,1,2]]]);
//# sourceMappingURL=main.92cef72b.chunk.js.map