(this["webpackJsonpztickybar-alarms"]=this["webpackJsonpztickybar-alarms"]||[]).push([[0],{35:function(e,t){},51:function(e,t,n){e.exports=n(94)},56:function(e,t,n){},80:function(e,t){},81:function(e,t){},87:function(e,t){},89:function(e,t){},94:function(e,t,n){"use strict";n.r(t);var r=n(8),a=n.n(r),i=n(44),o=n.n(i),c=(n(56),n(19)),s=n(2),u=n(3),p=(n(22),n(0)),l=n.n(p),f=n(18),h=n(10),d=n(47),w=n(46);function b(){try{return window.self!==window.top}catch(e){return!0}}var m=function(){function e(t,n){Object(s.a)(this,e),this.options=n,this.msalApplication=t}return Object(u.a)(e,[{key:"getAccessToken",value:function(e){var t=this,n=this;return new Promise(function(){var r=Object(f.a)(l.a.mark((function r(a,i){var o,c,s,u,p,f,d,w;return l.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("undefined"!==typeof(o=e)&&(c=o.scopes),"undefined"!==typeof c&&0!==c.length||(c=t.options.scopes),0!==c.length){r.next=8;break}throw(s=new Error).name="EmptyScopes",s.message="Scopes cannot be empty, Please provide a scopes",s;case 8:if(n.msalApplication.handleRedirectCallback((function(e,t){if(e)return i(e)})),!t.msalApplication.getAccount()){r.next=42;break}return u={scopes:c},r.prev=11,r.next=14,t.msalApplication.acquireTokenSilent(u);case 14:p=r.sent,a(p.accessToken),r.next=40;break;case 18:if(r.prev=18,r.t0=r.catch(11),!(r.t0 instanceof h.a)){r.next=38;break}if(r.prev=21,!b()){r.next=29;break}return r.next=25,t.msalApplication.acquireTokenPopup(u);case 25:f=r.sent,a(f.accessToken),r.next=30;break;case 29:case 30:r.next=36;break;case 32:r.prev=32,r.t1=r.catch(21),i(r.t1);case 36:r.next=40;break;case 38:i(r.t0);case 40:r.next=60;break;case 42:if(r.prev=42,d={scopes:c},!b()){r.next=53;break}return r.next=47,t.msalApplication.loginPopup(d);case 47:return r.next=49,t.msalApplication.acquireTokenSilent(d);case 49:w=r.sent,a(w.accessToken),r.next=55;break;case 53:return n.msalApplication.loginRedirect(d),r.abrupt("return");case 55:r.next=60;break;case 57:r.prev=57,r.t2=r.catch(42),i(r.t2);case 60:case"end":return r.stop()}}),r,null,[[11,18],[21,32],[42,57]])})));return function(e,t){return r.apply(this,arguments)}}())}}]),e}(),k=(n(61),n(78),n(82),["User.Read.All","User.ReadWrite.All"]),v={auth:{clientId:"443ae28d-8cf8-42fd-ba63-f403ac085ead",redirectUri:window.location.protocol+"//"+window.location.hostname+(80!==window.location.port&&443!==window.location.port&&""!==window.location.port?":"+window.location.port:"")+window.location.pathname,authority:"https://login.microsoftonline.com/common",storeAuthStateInCookie:!0}};new h.b(v).handleRedirectCallback((function(e,t){}));var g={authProvider:new m(new h.b(v),new w.MSALAuthenticationProviderOptions(k))};var x={me:function(){return e="/me",new Promise(function(){var t=Object(f.a)(l.a.mark((function t(n,r){var a,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=d.a.initWithMiddleware(g),t.prev=1,t.next=4,a.api(e).get();case 4:return i=t.sent,t.abrupt("return",n(i));case 8:return t.prev=8,t.t0=t.catch(1),t.abrupt("return",r(t.t0));case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e,n){return t.apply(this,arguments)}}());var e}};var y=function(){function e(){var t=this;Object(s.a)(this,e),this.tools=function(){return new Promise((function(e,t){e([])}))},this.setNotificationCount=function(e,n){window.parent&&window.parent.postMessage({action:"setNotificationCount",count:n,tileId:e,key:t._key},t._targetOrigin)},this._key="123",this._targetOrigin="*"}return Object(u.a)(e,[{key:"openerHref",get:function(){return this._openerHref}},{key:"tileId",get:function(){return this._tileId}}]),e}();y.init=function(){return new y};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement((function(){var e=Object(r.useState)(!1),t=Object(c.a)(e,2),n=(t[0],t[1],Object(r.useState)([])),i=Object(c.a)(n,2),o=i[0],s=i[1],u=Object(r.useState)({}),p=Object(c.a)(u,2),l=p[0],f=p[1];return Object(r.useEffect)((function(){x.me().then((function(e){f(e),y.init().setNotificationCount(3,2)})).catch((function(e){o.push({context:"OfficeGraph.me() ",error:e}),s(o)}))}),[]),a.a.createElement("div",null,"Alarms",JSON.stringify(l),"---",JSON.stringify(o))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[51,1,2]]]);
//# sourceMappingURL=main.8964205d.chunk.js.map